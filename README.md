# mcache

#### 介绍

mcache是一个整合caffeine+redis的二级缓存工具，对于读请求频繁访问的场景，有巨大的性能提升（同架构的已经经过生产实践中）。

#### 特性

1. 一级缓存采用Caffeine Cache，二级缓存采用redis。
2. 采用Spring AOP + Annotation 将缓存管理与业务逻辑进行解耦。
3. 采用懒加载机制 + 防止缓存穿透。
4. 加入redis异常重试降级，以及自动恢复功能。
5. 本地缓存结果copy，避免直接修改本地缓存引发问题。

#### 缓存一致性问题

1. 是以持久化数据库中的数据为标准，redis只作为缓存使用（不开启备份，出现服务宕机级别问题，所有数据都从数据库重新读取缓存，保证数据一致性）。
2. 先更新数据库，然后删除缓存，本地缓存通过使用消息中间件广播通知删除。
3. 如果删除redis缓存失败，会进行redis异常重试，超过重试次数就会触发降级，直连数据库。（已有的生产实践中只出现过机房出现事故，zk、redis等服务全部停摆，这个时候重试并没有什么用）
4. 如果删除本地缓存失败，则需要等待缓存失效。（本地缓存ttl默认设置5分钟，生产实践中，影响不大，在可以接受的范围）

#### 使用说明

1. xxxx
2. xxxx
3. xxxx